<?php
    require_once './php/db_creds.php';
    session_start();
    date_default_timezone_set('UTC');
    // Get configuration file location
    if ($_SESSION['dagah_dir']) {
      $configFile = $_SESSION['dagah_dir'] . "/config"; 
    } else {
      $configFile = "/home/dagah/dagah/config";
    }
    $message="";
    $fail = false;
    $update = true;
    $connection = mysqli_connect($db_hostname, $db_username, $db_password, $db_database);
    if (count($_POST)>0) {
        $message="";
        $characterpattern = '/[^A-Za-z0-9 \/_.\-\\\\]/i';
        if (preg_match($characterpattern, $_POST['WEBSERVER'])) {
          // Someone mucking with WEBSERVER
          $fail = true;
          $_POST['WEBSERVER'] = "";
          $message = "<div class='alert alert-danger'>WEBSERVER contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['IPADDRESS'])) {
          // Someone mucking with IPADDRESS
          $fail = true;
          $_POST['IPADDRESS'] = "";
          $message = "<div class='alert alert-danger'>IPADDRESS contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['SHELLIPADDRESS'])) {
          // Someone mucking with SHELLIPADDRESS
          $fail = true;
          $_POST['SHELLIPADDRESS'] = "";
          $message = "<div class='alert alert-danger'>SHELLIPADDRESS contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['DAGAHLOC'])) {
          // Someone mucking with DAGAHLOC
          $fail = true;
          $_POST['DAGAHLOC'] = "";
          $message = "<div class='alert alert-danger'>DAGAHLOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['SERVERTYPE'])) {
          // Someone mucking with SERVERTYPE
          $fail = true;
          $_POST['SERVERTYPE'] = "";
          $message = "<div class='alert alert-danger'>SERVERTYPE contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['SERVERPORT'])) {
          // Someone mucking with SERVERPORT
          $fail = true;
          $_POST['SERVERPORT'] = "";
          $message = "<div class='alert alert-danger'>SERVERPORT contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['RESOURCESDIR'])) {
          // Someone mucking with RESOURCESDIR
          $fail = true;
          $_POST['RESOURCESDIR'] = "";
          $message = "<div class='alert alert-danger'>RESOURCESDIR contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['CLONESLOC'])) {
          // Someone mucking with CLONESLOC
          $fail = true;
          $_POST['CLONESLOC'] = "";
          $message = "<div class='alert alert-danger'>CLONESLOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['SAVEDRUNSDIRECTORY'])) {
          // Someone mucking with SAVEDRUNSDIRECTORY
          $fail = true;
          $_POST['SAVEDRUNSDIRECTORY'] = "";
          $message = "<div class='alert alert-danger'>SAVEDRUNSDIRECTORY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['CAMPAIGNSDIRECTORY'])) {
          // Someone mucking with CAMPAIGNSDIRECTORY
          $fail = true;
          $_POST['CAMPAIGNSDIRECTORY'] = "";
          $message = "<div class='alert alert-danger'>SAVEDRUNSDIRECTORY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['RESULTSDIRECTORY'])) {
          // Someone mucking with RESULTSDIRECTORY
          $fail = true;
          $_POST['RESULTSDIRECTORY'] = "";
          $message = "<div class='alert alert-danger'>RESULTSDIRECTORY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['AGENTSDIRECTORY'])) {
          // Someone mucking with AGENTSDIRECTORY
          $fail = true;
          $_POST['AGENTSDIRECTORY'] = "";
          $message = "<div class='alert alert-danger'>AGENTSDIRECTORY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['MODEMDIRECTORY'])) {
          // Someone mucking with MODEMDIRECTORY
          $fail = true;
          $_POST['MODEMDIRECTORY'] = "";
          $message = "<div class='alert alert-danger'>MODEMDIRECTORY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['EXPLOITSDIR'])) {
          // Someone mucking with EXPLOITSDIR
          $fail = true;
          $_POST['EXPLOITSDIR'] = "";
          $message = "<div class='alert alert-danger'>EXPLOITSDIR contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['TARGETDIR'])) {
          // Someone mucking with TARGETDIR
          $fail = true;
          $_POST['TARGETDIR'] = "";
          $message = "<div class='alert alert-danger'>TARGETDIR contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['MODEMNUMBER'])) {
          // Someone mucking with MODEMNUMBER
          $fail = true;
          $_POST['MODEMNUMBER'] = "";
          $message = "<div class='alert alert-danger'>MODEMNUMBER contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['MODEMKEY'])) {
          // Someone mucking with MODEMKEY
          $fail = true;
          $_POST['MODEMKEY'] = "";
          $message = "<div class='alert alert-danger'>MODEMKEY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['MODEMPATH'])) {
          // Someone mucking with MODEMPATH
          $fail = true;
          $_POST['MODEMPATH'] = "";
          $message = "<div class='alert alert-danger'>MODEMPATH contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['BITLYTOKEN'])) {
          // Someone mucking with BITLYTOKEN
          $fail = true;
          $_POST['BITLYTOKEN'] = "";
          $message = "<div class='alert alert-danger'>BITLYTOKEN contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['DELAY'])) {
          // Someone mucking with DELAY
          $fail = true;
          $_POST['DELAY'] = "";
          $message = "<div class='alert alert-danger'>DELAY contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['APKTOOLLOC'])) {
          // Someone mucking with APKTOOLLOC
          $fail = true;
          $_POST['APKTOOLLOC'] = "";
          $message = "<div class='alert alert-danger'>APKTOOLLOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['ANDROIDSDK'])) {
          // Someone mucking with ANDROIDSDK
          $fail = true;
          $_POST['ANDROIDSDK'] = "";
          $message = "<div class='alert alert-danger'>ANDROIDSDK contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['APKSLOC'])) {
          // Someone mucking with APKSLOC
          $fail = true;
          $_POST['APKSLOC'] = "";
          $message = "<div class='alert alert-danger'>APKSLOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['AGENTCOMMANDFILE'])) {
          // Someone mucking with AGENTCOMMANDFILE
          $fail = true;
          $_POST['AGENTCOMMANDFILE'] = "";
          $message = "<div class='alert alert-danger'>AGENTCOMMANDFILE contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['KEYSTORELOC'])) {
          // Someone mucking with KEYSTORELOC
          $fail = true;
          $_POST['KEYSTORELOC'] = "";
          $message = "<div class='alert alert-danger'>KEYSTORELOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['KEYALIAS'])) {
          // Someone mucking with KEYALIAS
          $fail = true;
          $_POST['KEYALIAS'] = "";
          $message = "<div class='alert alert-danger'>KEYALIAS contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['KEYPASS'])) {
          // Someone mucking with KEYPASS
          $fail = true;
          $_POST['KEYPASS'] = "";
          $message = "<div class='alert alert-danger'>KEYPASS contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['ANDROIDNMAPLOC'])) {
          // Someone mucking with ANDROIDNMAPLOC
          $fail = true;
          $_POST['ANDROIDNMAPLOC'] = "";
          $message = "<div class='alert alert-danger'>ANDROIDNMAPLOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['TEMPLATESLOCATION'])) {
          // Someone mucking with TEMPLATESLOCATION
          $fail = true;
          $_POST['TEMPLATESLOCATION'] = "";
          $message = "<div class='alert alert-danger'>TEMPLATESLOCATION contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['TWITTERACCESSTOKEN'])) {
          // Someone mucking with TWITTERACCESSTOKEN
          $fail = true;
          $_POST['TWITTERACCESSTOKEN'] = "";
          $message = "<div class='alert alert-danger'>TWITTERACCESSTOKEN contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['TWITTERACCESSTOKENSECRET'])) {
          // Someone mucking with TWITTERACCESSTOKENSECRET
          $fail = true;
          $_POST['TWITTERACCESSTOKENSECRET'] = "";
          $message = "<div class='alert alert-danger'>TWITTERACCESSTOKENSECRET contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['PROFILESLOC'])) {
          // Someone mucking with PROFILESLOC
          $fail = true;
          $_POST['PROFILESLOC'] = "";
          $message = "<div class='alert alert-danger'>PROFILESLOC contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['WHATSAPPLOGIN'])) {
          // Someone mucking with WHATSAPPLOGIN
          $fail = true;
          $_POST['WHATSAPPLOGIN'] = "";
          $message = "<div class='alert alert-danger'>WHATSAPPLOGIN contains unallowed characters.</div>";  
        } else if(preg_match($characterpattern, $_POST['WHATSAPPPASSWORD'])) {
          // Someone mucking with WHATSAPPPASSWORD
          $fail = true;
          $_POST['WHATSAPPPASSWORD'] = "";
          $message = "<div class='alert alert-danger'>WHATSAPPPASSWORD contains unallowed characters.</div>"; 
        } else if(preg_match($characterpattern, $_POST['MODEMTYPE'])) {
          // Someone mucking with MODEMTYPE
          $fail = true;
          $_POST['MODEMTYPE'] = "";
          $message = "<div class='alert alert-danger'>MODEMTYPE contains unallowed characters.</div>"; 
        } else if(preg_match($characterpattern, $_POST['TWILIOSID'])) {
          // Someone mucking with TWILIOSID
          $fail = true;
          $_POST['TWILIOSID'] = "";
          $message = "<div class='alert alert-danger'>TWILIOSID contains unallowed characters.</div>"; 
        } else if(preg_match($characterpattern, $_POST['TWILIOTOKEN'])) {
          // Someone mucking with TWILIOTOKEN
          $fail = true;
          $_POST['TWILIOTOKEN'] = "";
          $message = "<div class='alert alert-danger'>TWILIOTOKEN contains unallowed characters.</div>"; 
        } else if(preg_match('/[0-9/+]/i', $_POST['TWILIONUMBER'])) {
          // Someone mucking with TWILIONUMBER
          $fail = true;
          $_POST['TWILIONUMBER'] = "";
          $message = "<div class='alert alert-danger'>TWILIONUMBER contains unallowed characters.</div>"; 
        } else if(preg_match('/[0-9/+]/i', $_POST['AGENTBLDPOLLINTRVL'])) {
          // Someone mucking with AGENTBLDPOLLINTRVL
          $fail = true;
          $_POST['AGENTBLDPOLLINTRVL'] = "";
          $message = "<div class='alert alert-danger'>AGENTBLDPOLLINTRVL contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['AGENTBLDUSER'])) {
          // Someone mucking with AGENTBLDUSER
          $fail = true;
          $_POST['AGENTBLDUSER'] = "";
          $message = "<div class='alert alert-danger'>AGENTBLDUSER contains unallowed characters.</div>";
        } else if(preg_match($characterpattern, $_POST['AGENTBLDPASS'])) {
          // Someone mucking with AGENTBLDPASS
          $fail = true;
          $_POST['AGENTBLDPASS'] = "";
          $message = "<div class='alert alert-danger'>AGENTBLDPASS contains unallowed characters.</div>";
        }


        if (!$fail) {
           $date = date('m-d-Y_h:i:s',time());
           $new_config = "# Config File Automatically Generated from Dagah GUI (Last Update: " . $date . ")\n";
           // check to see if data exists or not
           $sql = "SELECT * FROM configuration"; 
           $res = mysqli_query($connection, $sql);
           if (mysqli_num_rows($res) == 0) {
               $update = false;
           } 

           foreach($_POST as $key => $val) {
               if ($val != "Save") {
                   $stmt = mysqli_stmt_init($connection);
                   // determine which style of save
                   if ($update) {
                       // do update
                       mysqli_stmt_prepare($stmt, 'UPDATE configuration SET ValueText = ? WHERE KeyText= ?');
                       mysqli_stmt_bind_param($stmt, 'ss', $val, $key);
                       mysqli_stmt_execute($stmt);

                   } else {
                       // do INSERT (new)
                       $userID = $_SESSION['userid'];
                       mysqli_stmt_prepare($stmt, 'INSERT INTO configuration (UserID, KeyText, ValueText) VALUES (?, ?, ?)');
                       mysqli_stmt_bind_param($stmt, 'iss', $userID,$key, $val);
                       mysqli_stmt_execute($stmt);

                   }
                   $new_config .= $key . " = " . $val . "\n";
               }
           }
           // save notification
           $Comment = "Save Configuration Settings";
           $Type = "settings";
           $userID = $_SESSION['userid'];
           $stmt = mysqli_stmt_init($connection);
           mysqli_stmt_prepare($stmt, 'INSERT INTO notifications (Comment, Time, Type, UserID) VALUES (?,(now() - interval 4 hour),?,?)');
           mysqli_stmt_bind_param($stmt, 'ssi',$Comment,$Type,$userID);
           mysqli_stmt_execute($stmt);
 
           // backup existing config file
           $new_file = $configFile . "_" . $date;
           if (!copy($configFile,$new_file)) {
               $message = "<div class='alert alert-danger'>Config File Backup FAILED! <?php echo $configFile; ?> </div>";
           }

           // save new config file
           if (!file_put_contents($configFile, $new_config)) {
               $message = "<div class='alert alert-danger'>Config File Save FAILED! <?php echo $configFile; ?> </div>";
           }

           if (!$message) {
               // everything ok, go back to home
               header('Location:  /php/logout.php');
           }
        }       
    }
    if (isset($_SESSION['userid'])) {
        $sql="SELECT * FROM configuration";
        $result=mysqli_query($connection, $sql);
        // check configuration result... if empty, pre-load from existing config file
        $config_count=mysqli_num_rows($result);
        if ($config_count == 0) {
            // no configuration... preload existing config file contents
            $file =  fopen($configFile,"r");            
                while(!feof($file)) {
                    // load config file contents
                    $line = fgets($file);
                    if ($line[0] != "#") {
                        //not a comment line
                        $parse_line = split(" = ", $line);
                        $settings[trim($parse_line[0])] = trim($parse_line[1]);
                    }
                }
        } else {
            // configuration exists... load values from dB
            while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC)) {
                $settings[$row['KeyText']] = $row['ValueText'];
            }
        }
    } else {
        // no session data-- send back to login
        header('Location:  login.html');
    }
?>

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>System Configuration</title>

    <!-- Bootstrap Core CSS -->
    <link href="./components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">

    <!-- MetisMenu CSS -->
    <link href="./components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="./css/Dagah.css" rel="stylesheet">
    <link href="./css/Dagah_custom.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="./components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <?php include('dagah_nav.html'); ?>
		
        <!-- Page Content -->
        <div id="page-wrapper">
            <div class="container-fluid">
                <?php echo $message ?>
                <h2>System Configuration</h2>
                <div class="row">
                <!-- /.col-lg-6 -->
                <div class="col-lg-12">
                  <form role="form" method="post">
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            Dagah Engine <div id="lastSave"></div>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="form-group">
                                <label>WEBSERVER</label>
                                <input class="form-control" name="WEBSERVER" value="<?php echo $settings['WEBSERVER'] ?>"/>
                                <p class="help-block">Absolute directory path to web server files /var/www/html</p>
                            </div>
                            <div class="form-group">
                                <label>IPADDRESS</label>
                                <input class="form-control" name="IPADDRESS" value="<?php echo $settings['IPADDRESS'] ?>"/>
                                <p class="help-block">address of webserver</p>
                            </div>
                            <div class="form-group">
                                <label>SHELLIPADDRESS</label>
                                <input class="form-control" name="SHELLIPADDRESS" value="<?php echo $settings['SHELLIPADDRESS'] ?>"/>
                                <p class="help-block">address for shell listeners, usually same as IPADDRESS</p>
                            </div>
                            <div class="form-group">
                                <label>DAGAHLOC</label>
                                <input class="form-control" name="DAGAHLOC" value="<?php echo $settings['DAGAHLOC'] ?>"/>
                                <p class="help-block">Absolute directory path for the shevirah software</p>
                            </div>
                            <div class="form-group">
                                <label>SERVERTYPE</label>
                                <input class="form-control" name="SERVERTYPE" value="<?php echo $settings['SERVERTYPE'] ?>"/>
                                <p class="help-block">web server type: apache|simpleython</p>
                            </div>
                            <div class="form-group">
                                <label>SERVERPORT</label>
                                <input class="form-control" name="SERVERPORT" value="<?php echo $settings['SERVERPORT'] ?>"/>
                                <p class="help-block">port for webserver: 80</p>
                            </div>
                           <div class="form-group">
                                <label>AGENTBLDHOST</label>
                                <input class="form-control" name="AGENTBLDHOST" value="<?php echo $settings['AGENTBLDHOST'] ?>"/>
                                <p class="help-block">URL of iOS Agent Build Server.  Do not change unless running your own iOS agent build server.</p>
                            </div>
                           <div class="form-group">
                                <label>AGENTBLDIOSJOB</label>
                                <input class="form-control" name="AGENTBLDIOSJOB" value="<?php echo $settings['AGENTBLDIOSJOB'] ?>"/>
                                <p class="help-block">Jenkins Job name for IOS Agent Build process.</p>
                            </div>
                           <div class="form-group">
                                <label>AGENTBLDANDROIDJOB</label>
                                <input class="form-control" name="AGENTBLDANDROIDJOB" value="<?php echo $settings['AGENTBLDANDROIDJOB'] ?>"/>
                                <p class="help-block">Jenkins Job name for Android Agent Build process.</p>
                            </div>
                           <div class="form-group">
                                <label>AGENTBLDUSER</label>
                                <input class="form-control" name="AGENTBLDUSER" value="<?php echo $settings['AGENTBLDUSER'] ?>"/>
                                <p class="help-block">UserID for Jenkins Server for IOS and Android Agent Build processes.</p>
                            </div>
                           <div class="form-group">
                                <label>AGENTBLDPASS</label>
                                <input class="form-control" name="AGENTBLDPASS" value="<?php echo $settings['AGENTBLDPASS'] ?>"/>
                                <p class="help-block">Password for Jenkins Server for IOS and Android Agent Build processes.</p>
                            </div>
                           <div class="form-group">
                                <label>AGENTBLDPOLLINTRVL</label>
                                <input class="form-control" name="AGENTBLDPOLLINTRVL" value="<?php echo $settings['AGENTBLDPOLLINTRVL'] ?>"/>
                                <p class="help-block">Polling interval for Jenkins Server for IOS and Android Agent Build processes.</p>
                            </div>

                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">File Locations (relative to DAGAHLOC)</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>RESOURCESDIR</label>
                                    <input class="form-control" name="RESOURCESDIR" value="<?php echo $settings['RESOURCESDIR'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for resources</p>
                                </div>
                                <div class="form-group">
                                    <label>CLONESLOC</label>
                                    <input class="form-control" name="CLONESLOC" value="<?php echo $settings['CLONESLOC'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for cloned webpages</p>
                                </div>
                                <div class="form-group">
                                    <label>SAVEDRUNSDIRECTORY</label>
                                    <input class="form-control" name="SAVEDRUNSDIRECTORY" value="<?php echo $settings['SAVEDRUNSDIRECTORY'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for saved campaign runs</p>
                                </div>
                                <div class="form-group">
                                    <label>CAMPAIGNSDIRECTORY</label>
                                    <input class="form-control" name="CAMPAIGNSDIRECTORY" value="<?php echo $settings['CAMPAIGNSDIRECTORY'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for saved campaigns</p>
                                </div>
                                <div class="form-group">
                                    <label>RESULTSDIRECTORY</label>
                                    <input class="form-control" name="RESULTSDIRECTORY" value="<?php echo $settings['RESULTSDIRECTORY'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for results pages</p>
                                </div>
                                <div class="form-group">
                                    <label>AGENTSDIRECTORY</label>
                                    <input class="form-control" name="AGENTSDIRECTORY" value="<?php echo $settings['AGENTSDIRECTORY'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for agents directory</p>
                                </div>
                                <div class="form-group">
                                    <label>MODEMDIRECTORY</label>
                                    <input class="form-control" name="MODEMDIRECTORY" value="<?php echo $settings['MODEMDIRECTORY'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for modem directory</p>
                                </div>
                                <div class="form-group">
                                    <label>EXPLOITSDIR</label>
                                    <input class="form-control" name="EXPLOITSDIR" value="<?php echo $settings['EXPLOITSDIR'] ?>"/>
                                    <p class="help-block">Exploits Directory</p>
                                </div>
                                <div class="form-group">
                                    <label>TARGETDIR</label>
                                    <input class="form-control" name="TARGETDIR" value="<?php echo $settings['TARGETDIR'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for Targets Directory</p>
                                </div>
                                <div class="form-group">
                                    <label>TEMPLATESLOCATION</label>
                                    <input class="form-control" name="TEMPLATESLOCATION" value="<?php echo $settings['TEMPLATESLOCATION'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for Harvester Templates Directory</p>
                                </div>
                                <div class="form-group">
                                    <label>PROFILESLOC</label>
                                    <input class="form-control" name="PROFILESLOC" value="<?php echo $settings['PROFILESLOC'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for Apple Configurator generated profiles</p>
                                </div>

                            </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">DagahModemBridge Configuration</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>MODEMNUMBER</label>
                                    <input class="form-control" name="MODEMNUMBER" value="<?php echo $settings['MODEMNUMBER'] ?>"/>
                                    <p class="help-block">phone number of SMS bridge phone</p>
                                </div>
                                <div class="form-group">
                                    <label>MODEMKEY</label>
                                    <input class="form-control" name="MODEMKEY" value="<?php echo $settings['MODEMKEY'] ?>"/>
                                    <p class="help-block">key for modem</p>
                                </div>
                            
                                <div class="form-group">
                                    <label>MODEMPATH</label>
                                    <input class="form-control" name="MODEMPATH" value="<?php echo $settings['MODEMPATH'] ?>"/>
                                    <p class="help-block">Relative directory path under WEBSERVER for modem control path</p>
                                </div>
                            </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">Twilio Configuration</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>MODEMTYPE</label>
                                    <label class="radio-inline">
                                        <input id="modemtype1" type="radio" value="app" name="MODEMTYPE" required="required" checked />
                                        app
                                    </label>
                                    <label class="radio-inline">
                                        <input id="modemtype2" type="radio" value="twilio" name="MODEMTYPE" required="required" />
                                        twilio
                                    </label>
                                    <p class="help-block">Set to "app" to use DagahModemBridge or "twilio" to set to Twilio</p>
                                </div>
                                <div class="form-group">
                                    <label>TWILIOSID</label>
                                    <input class="form-control" name="TWILIOSID" value="<?php echo $settings['TWILIOSID'] ?>"/>
                                    <p class="help-block">SID for Twilio account (create at <A HREF="https://www.twilio.com/console/account/settings">Twilio Site</A></p>
                                </div>
                                <div class="form-group">
                                    <label>TWILIOTOKEN</label>
                                    <input class="form-control" name="TWILIOTOKEN" value="<?php echo $settings['TWILIOTOKEN'] ?>"/>
                                    <p class="help-block">Token for Twilio account (create at <A HREF="https://www.twilio.com/console/account/settings">Twilio Site</A></p>
                                </div>
                                <div class="form-group">
                                    <label>TWILIONUMBER</label>
                                    <input class="form-control" name="TWILIONUMBER" value="<?php echo $settings['TWILIONUMBER'] ?>"/>
                                    <p class="help-block">Phone Number for Twilio account (create at <A HREF="https://www.twilio.com/console/phone-numbers/incoming">Twilio Site</A></p>
                                </div>
                            </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">Attacks Configuration</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>BITLYTOKEN</label>
                                    <input class="form-control" name="BITLYTOKEN" value="<?php echo $settings['BITLYTOKEN'] ?>"/>
                                    <p class="help-block">url shortening account token  See <a href=https://dev.bitly.com/authentication.html>OAUTH Access</a> for more information</p>
                                </div>
                                <div class="form-group">
                                    <label>DELAY</label>
                                    <input class="form-control" name="DELAY" value="<?php echo $settings['DELAY'] ?>"/>
                                    <p class="help-block">Delay in seconds before sending out SMS messages after launching a campaign</p>
                                </div>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>TWITTERACCESSTOKEN</label>
                                    <input class="form-control" name="TWITTERACCESSTOKEN" value="<?php echo $settings['TWITTERACCESSTOKEN'] ?>"/>
                                    <p class="help-block">Token for Twitter Account used in Twitter Delivery Methods</p>
                                </div>
                                <div class="form-group">
                                    <label>TWITTERACCESSTOKENSECRET</label>
                                    <input class="form-control" name="TWITTERACCESSTOKENSECRET" value="<?php echo $settings['TWITTERACCESSTOKENSECRET'] ?>"/>
                                    <p class="help-block">Secret used with above Twitter Access Token</p>
                                </div>
                                <div class="form-group">
                                    <label>WHATSAPPLOGIN</label>
                                    <input class="form-control" name="WHATSAPPLOGIN" value="<?php echo $settings['WHATSAPPLOGIN'] ?>"/>
                                    <p class="help-block">WhatsApp Login Account for Messaging App Attacks over the WhatsApp network.  To create an account, visit <a href="https://www.whatsapp.com/download/">WhatsApp</a>.</p>
                                </div>
                                <div class="form-group">
                                    <label>WHATSAPPPASSWORD</label>
                                    <input class="form-control" name="WHATSAPPPASSWORD" value="<?php echo $settings['WHATSAPPPASSWORD'] ?>"/>
                                    <p class="help-block">Password associated with above WhatsApp account.</p>
                                </div>
                            </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">Harvester Attacks Configuration</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>USERAGENT</label>
                                    <input class="form-control" name="USERAGENT" value="<?php echo $settings['USERAGENT'] ?>"/>
                                    <p class="help-block">User agent string in HARVESTER</p>
                                </div>
                            </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">Android Agent Attacks Configurations</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>APKTOOLLOC</label>
                                    <input class="form-control" name="APKTOOLLOC" value="<?php echo $settings['APKTOOLLOC'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for APKTool</p>
                                </div>
                                <div class="form-group">
                                    <label>APKSLOC</label>
                                    <input class="form-control" name="APKSLOC" value="<?php echo $settings['APKSLOC'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for APKs to be backdoored</p>
                                </div>
                                <div class="form-group">
                                    <label>ANDROIDSDK</label>
                                    <input class="form-control" name="ANDROIDSDK" value="<?php echo $settings['ANDROIDSDK'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for Android SDK</p>
                                </div>
                                <div class="form-group">
                                    <label>AGENTCOMMANDFILE</label>
                                    <input class="form-control" name="AGENTCOMMANDFILE" value="<?php echo $settings['AGENTCOMMANDFILE'] ?>"/>
                                    <p class="help-block">File name for post-exploitation commands for agent</p>
                                </div>
                                <div class="form-group">
                                    <label>KEYSTORELOC</label>
                                    <input class="form-control" name="KEYSTORELOC" value="<?php echo $settings['KEYSTORELOC'] ?>"/>
                                    <p class="help-block">Keystore password</p>
                                </div>
                                <div class="form-group">
                                    <label>KEYALIAS</label>
                                    <input class="form-control" name="KEYALIAS" value="<?php echo $settings['KEYALIAS'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for Android key alias</p>
                                </div>
                                <div class="form-group">
                                    <label>KEYPASS</label>
                                    <input class="form-control" name="KEYPASS" value="<?php echo $settings['KEYPASS'] ?>"/>
                                    <p class="help-block">Keystore password</p>
                                </div>
                            </div>
                    </div>
                    <div class="panel panel-info">
                        <div class="panel-heading">Post Exploitation Configurations</div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>ANDROIDNMAPLOC</label>
                                    <input class="form-control" name="ANDROIDNMAPLOC" value="<?php echo $settings['ANDROIDNMAPLOC'] ?>"/>
                                    <p class="help-block">Relative directory path under DAGAHLOC for NMAP Android Location</p>
                                </div>
                            </div>
                    </div>

                    <input type="submit" class="btn btn-primary" name="submit" value="Save">
                    <input type="button" class="btn btn-primary" value="Cancel" onclick="location.href = 'dagah_home.html'" />
                    <?php echo $message ?>
                  </form>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-6 -->
                
            </div>
            </div>
            <!-- /.container-fluid -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="./components/jquery/dist/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="./components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="./components/metisMenu/dist/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="./js/sb-admin-2.js"></script>

</body>

</html>
