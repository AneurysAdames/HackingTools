<?php
    require_once './php/db_creds.php';
    // check for existing session
    session_start();
    if (!isset($_SESSION['userid'])) {
        // no session data-- send back to login
        header('Location:  login.html');
    }
?>
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Dagah</title>

    <!-- Bootstrap Core CSS -->
    <link href="./components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">

    <!-- MetisMenu CSS -->
    <link href="./components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">
    <link href="./css/timeline.css" rel="stylesheet" />


    <!-- Custom CSS -->
    <link href="./css/Dagah.css" rel="stylesheet">
    <link href="./css/Dagah_custom.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="./components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <?php include('dagah_nav.html'); ?>
		
        <!-- Page Content -->
        <div id="page-wrapper">
            <div class="container-fluid">
              <html>
<head>
<meta charset="UTF-8">
<title>Dagah Documentation</title>
</head>

<body>
<h1>Shevirah DAGAH Mobility Penetration Testing Software</h1>
<h2>Introduction</h2>
<p>With Dagah, penetration testers can design campaigns of penetration test attacks against targets (phone numbers, userids), launch them, and review the results.  Available attacks include basic phishing attacks, where targets are prompted to click a link to a benign warning page; harvester attacks, where targets are prompted to click a link to a facsimile of a login page in order to capture their credentials; agent attacks, where targets are prompted to click a link to a simulated malware application for download and install; and profile attacks, where targets are prompted to click a link to a configuration file for iOS (Apple) devices to change their security settings.  Each of these attacks can be delivered over Short Message Service (SMS), Quick Response (QR) Codes, Near-Field Communications (NFC), or over Messaging Applications including Twitter and WhatsApp.  Future attacks will include Client side (remote) attacks that return a reverse-shell from the target phone.</p>
<h2>Concept Of Operations</h2>
<p>The software consists of four components:
	<ul><li>A server-based engine: which can be interfaced via command-line</li>
	<li>A web-based GUI: which can be interfaced via a browser</li>
	<li>A means to bridge the engine to the mobile network for sending SMS messages</li>
	<li>Agents for targeted phones</li>
    </ul>
</p>
 <p>A penetration tester designs CAMPAIGNs consisting of ATTACKs and runs them against TARGETs.  Targets are phone numbers.  Any number of attacks can be run within a campaign and a campaign can be run against a set of targets.  </p>
 <p>Attacks are of a type:  
	<ul><li><b>Basic Phishing:</b>  Simulating phishing to draw mobile users into following a link.  This emulates how a hacker might trick a user into installing a piece of malware.</li>
	<li><b>Harverster:</b>  Simulating a phishing attack to draw mobile users to a fake website to harvest their user credentials.  This emulates how a hacker might trick a user into providing their credentials to a web service.</li>
	<li><b>Agent:</b>  Simulating a phishing attack to trick users into side loading a "malicious" application containing a backdoor remote agent.  This emulates both how a hacker might trick a user into installing a piece of malware and demonstrates what malware would be able to do on a target's device.</li>
	<li><b>Profile:</b> Simulating an iOS (Apple)-specific attack to trick users into installing a new configuration profile.  This emulates how a hacker might trick a user into lowering their security settings or installing a new certificate in the trust chain.</li>
	<li><b>Client Side:</b> Simulates exploiting mobile devices with client-side vulnerabilities. This will be available in future releases.</li>
    </ul>
</p>
<p>Each attack can be delivered via five methods:
	<ul><li>SMS:  Text messages</li>
	<li>QR Codes: A graphic image that contains an encoded URI that can be printed and displayed</li>
	<li>NFC:  A broadcast message that can be received by nearby mobile devices taking them to a URI</li>
	<li>MESSAGING APP:  A message sent via a messaging application. Twitter and WhatsApp are currently available.  More will be added in future releases. </li>
	<li>EXTERNAL:  A message delivered outside of Dagah such as via emails</li>
    </ul>
</p>
<p>Attacks are bundled into Campaigns.  A campaign is created, staged, and then run against groups of targets.  The same campaign can be run against another group of targets later for A/B testing.  Results are reported per campaign.</p>
<p>All attacks using SMS delivery methods require a bridge to the mobile network.  There are two choices: Use the <a HREF="http://www.twilio.com">Twilio service</a> or use the supplied <a href="./DagahModemBridge.apk">DagahModemBridge</a> Android application.  To use Twilio, you'll need a Twilio SID, Password, and Number (see configuration below).  For the DagahModemBridge, you'll need an Android Smartphone with a phone number.  In the case of Twilio, the Twilio Phone Number will be the origination number for all SMS attacks.  For the DagahModemBridge, the phone number of the smartphone running the sapplication will be the originating number for all SMS attacks.  Which method is used is determined by the MODEMTYPE configuration item described below.</p>
<p>All attacks usng NFC delivery methods require the use of the DagahModemBridge application.</p>
<h2>Web GUI Operations</h2>
 <p><strong>Manage Users:</strong> 	This dialog allows you to create GUI user accounts.  It is recommended to use the Administrator account (Admin Rights) to set up the system configuration and a regular account (User Rights) to operate the software.  This dialog also allows users to be deleted and their passwords reset.</p> 
 <p><strong>System Configuration:</strong> 	This is the list of dagah engine configurations.  Most will not need to be changed.  The following should be changed:
	<ul><li>IPADDRESS: change this to the IP address of the dagah engine</li>
	<li>SHELLIPADDRESS: change this to the IP address of the dagah engine.</li>
        <li>MODEMTYPE: Set to either "app" to use the DagahModemBridge.apk or to "twilio" to use a Twilio account.</li>
        <li>MODEMNUMBER: set this to the phone number of the device used to run the DagahModemBridge application</li>
        <li>MODEMKEY: set this to a unique value to distinguish your DagahModemBridge from anyone else's</li>
        <li>TWILIOSID and TWILIOTOKEN:  These need to match your Twilio account to use this feature.  You can retrieve or create these at <A HREF="https://www.twilio.com/console/account/settings">Twilio website</A> </li>
        <li>TWILIONUMBER: Phone number used when using the Twilio service to send SMS messages.  Retrieve from <A HREF="https://www.twilio.com/console/phone-numbers/incoming">Twilio website</A></li>
	<li>BITLYTOKEN: To shorten the URLs sent in phishing campaigns, the engine uses the bit.ly service.  Enter your OATH_AUTH token for your Bit.ly account by retrieving it from here: https://bitly.com/a/oauth_apps</li>
	<li>TWITTERACCESSTOKEN: To use the Twitter service as a Delivery Method, enter an access token for the originating account.  To create an Access Token, you'll need to the following from the command line: <code>python dagah2.pyc Connect twitter</code>  Answer the prompts and copy the resulting strings.</li>
	<li>TWITTERACCESSTOKENSECRET: Secret to accompany Twitter access token above.</li>
	<li>WHATSAPPLOGIN: To use the WhatsApp service as a Delivery Method, enter a login and password value for a valid WhatsApp account.  To retrieve the password for a WhatsApp userid, you'll need the following from the command line: <code>python dagah2.pyc Connect whatsapp &lt;countrycode&gt; &lt;number&gt; </code> </li>
	<li>WHATSAPPPASSWORD: Password for above account.</li>
    </ul>
</p>
<p><strong>Dashboard:</strong>  This is the main screen for the software.  It shows penetration test flow:
<ol><li>Create Attacks</li>
<li>Create a Campaign</li>
<li>Create a Target List</li>
<li>Run a Campaign</li>
<li>View Results</li>
</ol>
</p>
<p><strong>Design New Attack:</strong>	From this dialog, you can create a new attack to be part of a campaign.  Attacks consist of the following attributes:
	<ul><li>Type:  			Basic, Harvester, Agent, or Profile</li>
	<li>Label: 			A Unique label for the attack</li>
	<li>Page:  			the target file name for a phishing attack (e.g. index.html)</li>
	<li>Delivery Method: 	SMS, NFC, QRC, MessagingApp, or External</li>
	<li>For Basic Attacks:
		"webpagetext="	Text to appear on webpage where the users are directed (e.g. This was a simulated phishing attack.  As outlined in your awareness training, please review links prior to clicking them.)</li>
	<li>For Harvester Attacks:
		"clonepage=": The web login page to clone (URI)
<br/>NOTE: Experiment with this outside of dagah to get a good page.  Avoid including cgi-arguments in the URI (?something=something).  Avoid login pages that break across two-pages.  Avoid login pages with excessive javascript or multiple forms on the same page.</li>
	<li>For Agent Attacks:
	"backdoorapp=": directory and file name for android application to backdoor the agent into or enter "none" to simply use the agent as is. Both the Android and iOS agents will be sent, but only the AndroidAgent will be backdoored if this option is chosen.</li>
	<li>For Profile Attacks:
	"profile_file=": directory and file name for a profile created with the <A HREF="https://support.apple.com/en-us/HT205285">Apple Configurator v2.0 software </a>. </li>
	<li>For SMS Delivery:
		"smstext=": Text to appear in the text sent to the target (e.g. Your timesheet wasn't processed correctly.  Please follow this link to update your timesheet and avoid delays in payroll. ).  You can also pick an SMS message from a list of templates we've included or create your own with the SMS Templates option in the side menu.</li>
   </ul>
</p>
<p><strong>View Saved Attacks:</strong>	From this dialog you can review the list of saved attacks and each of their attack attributes.  You can also delete an attack from this window.</p>
<p><strong>Target Lists:	</strong>	From this dialog you can view existing target groups or create a new target group.  Uploaded files should have the format:
	<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phonenumeber with countrycode, [target label]
<br/><br/>Example:
	<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17036207272, PapaJohns
	<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17036209664
</p>
<p>NOTE: the free version of dagah limits target groups to one device number.  Groups can contain more than one phone number, but all but the first number will be ignored in an attack.</p>
<p><strong>Design New Campaign:</strong>	From this dialog, you can create a new campaign of one or more attacks by selecting the attacks from the list and providing a unique campaign label.  Once created, the dagah engine "stages" the campaign resources for a run.</p>
<p>NOTE: the free version of dagah limits campaigns to one attack. Campaigns can consiste of more than one attack, but only the first attack will be executed.  </p>
<p><strong>View Saved Campaigns:	</strong>From this dialog, you can review the list of saved campaigns and their attack attributes.  The "View Staging Output" shows the feedback from the dagah engine when the campaign was created.  Check this dialog for any errors prior to executing the campaign.  Campaigns can also be deleted from this window.</p>
<p><strong>Execute Campaigns:</strong>	From this dialog, you can execute a campaign against a target group.  Pick a campaign and a target group and select "Run Now".
Upon execution, the campaign is passed to the dagah engine for processing.  For campaigns with SMS delivery methods, ensure either the Twilio service is configured or the DagahModemBridge is connected.  For campaigns with NFC delivery methods, ensure the DagahModemBridge application is connected. 
</p>
<p><strong>View Executed Campaigns:</strong>	From this dialog, you can review the campaigns that have been run, their attributes, and the results.  <br/><br/>For QRC attacks, the image of the QR Code is accessible under the "View Attacks" button. <br/>The "Run Output" shows the feedback from the dagah engine when the campaign was run.  Check this dialog for any errors.  
<br/>The "Show Results" displays the results from the campaign attacks.
<br/>For <strong>Basic Phishing Attacks</strong>, this shows the datetime stamp, phonenumber, and User-Agent string of any devices that responded to the Basic Phishing Attack.  Keep in mind that Basic Phishing Attacks using delivery methods other than SMS are broadcasts and therefore do not record the phone# of respondents.  
<br/>For <strong>Harvester Attacks</strong>, this shows the list of data the user entered in the harvester clone site such as userid and passwords.  The list of attributes is determined by login form from the chosen clone site.
<br/>For <strong>Agent Attacks</strong>, this shows the phonenumbers of the devices that installed the agent, a link to the "facts.txt" file about the configuration of the devices, a list of post-exploitation commands that can be run against the agents, and any results files from those commands.
<br/>For <strong>Profile Attacks</strong>, this shows the datetime stamp, phonenumber, and User-Agent string of any devices that responded to the Profile attack.  Keep in mind that Basic Phishing Attacks using delivery methods other than SMS are broadcasts and therefore do not record the phone# of respondents.  
<br/> The Agent Commands are:
<ul><li>APKS none		Get a list of installed apps from the devices and stores them in "APKS.txt"</li>
	<li>UAPK apk:apk name	ANDROID ONLY: Retrieves an APK from the device (e.g. com.sec.android.app.samsungapps)</li>
	<li>SPAM target:number,message:textmessage	ANDROID ONLY: Send a text to number saying message</li>
	<li>DELE none 		ANDROID ONLY: Prompts the User to delete Agent from target phone</li>
	<li>DOWN file:todownload 	Send a file from the engine to the phone</li>
	<li>UPLD file:toupload 	Retrieve a file from the phone</li>
	<li>GETS none		ANDROID ONLY: Retrieves the security settings from the device and stores them in "settings.txt"</li>
	<li>SET setting:tochange,value:toset	ANDROID ONLY: Sets a security setting on the device </li> 
</ul>
</p>
<p>See <a href="https://developer.android.com/reference/android/app/admin/DevicePolicyManager.html">Android Documentation</a> for full detail on settings.</p>
</body>
</html>
            <!-- /.row -->
            </div>
            <!-- /.container-fluid -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="./components/jquery/dist/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="./components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="./components/metisMenu/dist/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="./js/sb-admin-2.js"></script>

</body>

</html>
